p8105_hw2_zj2357
================
Zekai Jin
2022-10-02

First of all, we should include the libraries we are using and prepare
the dataset.

``` r
library(tidyverse)
library(readxl)
```

# Problem 1

``` r
nyc_transit = read_csv(
  "data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>%
  janitor::clean_names() %>%
  select(line,
         station_name,
         station_latitude,
         station_longitude,
         route1:route11,
         entry,
         vending,
         entrance_type,
         ada) %>%
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

So far, the dataset(1868 rows, 19 columns) contains the information of
all entries/exits from NYC transit, including the station info, the
routes, the vending machine and ADA compliance. I cleaned the data under
the instruction of the problem, and the data is not tidy.

First, the datatype of some columns are not correct. For example, the
“vending” and “ada” columns should be logical, and “entrance_type”
variable should be a factor. Meanwhile, the “route” info is not arranged
in a tidy way. Lastly, the information for the station, such as the
position of the station and routes, is mixed with information for
entrances, such as vending machine information. This introduced
redundancy to the data that we don’t need.

Based on the previous analysis, we can further tidy the data, and finish
the problems:

``` r
nyc_transit =
  mutate(nyc_transit,
         vending = ifelse(vending == "YES", TRUE, FALSE),
         entrance_type = factor(entrance_type))
nyc_station = select(nyc_transit,-entry,-vending,-entrance_type) %>%
  unique()
nyc_station_distinct = distinct(nyc_station,line,station_name,.keep_all = TRUE)

nyc_entrance = select(nyc_transit,line,station_name,entry,vending,entrance_type)

sum(nyc_entrance$vending == FALSE & nyc_entrance$entry)/sum(nyc_entrance$vending == FALSE)
```

    ## [1] 0.3770492

``` r
nyc_station_distinct =
  pivot_longer(
    nyc_station_distinct,
    route1:route11,
    names_to = "route_number",
    values_to = "route"
  ) %>%
  drop_na(route)
```

# Problem 2

``` r
mr_trash_df =
  read_excel(
    "data/Trash Wheel Collection Data.xlsx",
    sheet = "Mr. Trash Wheel",
    range = "A2:N549"
  ) %>%
  janitor::clean_names() %>%
  mutate(
    sports_balls = as.integer(sports_balls),
    year = as.double(year),
    trash_wheel = rep("Mr.",547)
  )

prof_trash_df = 
  read_excel(
    "data/Trash Wheel Collection Data.xlsx",
    sheet = "Professor Trash Wheel",
    range = "A2:M96"
  ) %>%
  janitor::clean_names() %>%
  mutate(
    trash_wheel = rep("Professor", 94)
  )
  
trash_df = full_join(mr_trash_df, prof_trash_df)
```

    ## Joining, by = c("dumpster", "month", "year", "date", "weight_tons",
    ## "volume_cubic_yards", "plastic_bottles", "polystyrene", "cigarette_butts",
    ## "glass_bottles", "grocery_bags", "chip_bags", "homes_powered", "trash_wheel")

# Problem 3

``` r
rm(list = ls())

pol_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  separate(
    mon,
    into = c("year","month","day"),
    sep =  "-"
  ) %>%
  mutate(
    president = ifelse(prez_dem == 1, "dem", "gop"),
    year = as.double(year),
    month = month.abb[as.integer(month)]
  ) %>%
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  separate(
    date,
    into = c("month","day","year"),
    sep =  "/"
  ) %>%
  mutate(
    year = as.double(year),
    year = ifelse(year > 30, year + 1900, year + 2000),
    month = month.abb[as.integer(month)]
  ) %>%
  select(year, month, close)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemp_df = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(
    Jan:Dec,
    names_to = "Month",
    values_to = "Unemployment"
  ) %>%
  janitor::clean_names() %>%
  na.omit()
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
joined_df =
  full_join(pol_df, snp_df) %>%
  full_join(unemp_df)
```

    ## Joining, by = c("year", "month")
    ## Joining, by = c("year", "month")
